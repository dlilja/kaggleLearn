{"paragraphs":[{"text":"%md\n# Kaggle Pandas Course\n\nThis notebook covers reasonable Apache Spark translations of my solutions to the Kaggle Learn course on Pandas. It requires the package `org.xerial.sqlite-jdbc.3.23.1` for one of the solutions and `python`'s `seaborn` package for making a number of plots. It also assumes that the required data are in a folder called `data` inside the working directory of the notebook.","user":"anonymous","dateUpdated":"2018-08-30T11:16:49+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535620217071_-1660801626","id":"20180830-111017_917175274","dateCreated":"2018-08-30T11:10:17+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3659","dateFinished":"2018-08-30T11:16:49+0200","dateStarted":"2018-08-30T11:16:49+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Kaggle Pandas Course</h1>\n<p>This notebook covers reasonable Apache Spark translations of my solutions to the Kaggle Learn course on Pandas. It requires the package <code>org.xerial.sqlite-jdbc.3.23.1</code> for one of the solutions and <code>python</code>&rsquo;s <code>seaborn</code> package for making a number of plots. It also assumes that the required data are in a folder called <code>data</code> inside the working directory of the notebook.</p>\n</div>"}]}},{"text":"%md\n## Creating, reading and writing","user":"anonymous","dateUpdated":"2018-08-30T11:10:41+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605016_870892530","id":"20180829-220202_102300628","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1536","dateFinished":"2018-08-30T11:10:41+0200","dateStarted":"2018-08-30T11:10:41+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Creating, reading and writing</h2>\n</div>"}]}},{"text":"%md\n### Exercise 1","user":"anonymous","dateUpdated":"2018-08-30T11:10:54+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605020_-2076743434","id":"20180830-085255_623319210","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1537","dateFinished":"2018-08-30T11:10:54+0200","dateStarted":"2018-08-30T11:10:54+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 1</h3>\n</div>"}]}},{"text":"val df1 = List((30, 21)).toDF(\"Apples\", \"Bananas\")\ndf1.show","user":"anonymous","dateUpdated":"2018-08-30T11:07:04+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605021_133763979","id":"20180829-220243_767502813","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-08-30T11:07:04+0200","dateFinished":"2018-08-30T11:07:07+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1538","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [Apples: int, Bananas: int]\n+------+-------+\n|Apples|Bananas|\n+------+-------+\n|    30|     21|\n+------+-------+\n\n"}]}},{"text":"%md\n### Exercise 2","user":"anonymous","dateUpdated":"2018-08-30T11:10:59+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605021_468272944","id":"20180829-220748_348946599","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1539","dateFinished":"2018-08-30T11:10:59+0200","dateStarted":"2018-08-30T11:10:59+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 2</h3>\n</div>"}]}},{"text":"val df2 = List((\"2017 Sales\", 35, 32), (\"2018 Sales\", 41, 34)).toDF(\"Index\", \"Apples\", \"Bananas\")\ndf2.show","user":"anonymous","dateUpdated":"2018-08-30T11:07:10+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605022_897494645","id":"20180830-085311_558322596","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1540","dateFinished":"2018-08-30T11:07:11+0200","dateStarted":"2018-08-30T11:07:10+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [Index: string, Apples: int ... 1 more field]\n+----------+------+-------+\n|     Index|Apples|Bananas|\n+----------+------+-------+\n|2017 Sales|    35|     32|\n|2018 Sales|    41|     34|\n+----------+------+-------+\n\n"}]}},{"text":"%md\n### Exercise 3","user":"anonymous","dateUpdated":"2018-08-30T11:11:03+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605022_-1531546187","id":"20180830-090717_637949266","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1541","dateFinished":"2018-08-30T11:11:03+0200","dateStarted":"2018-08-30T11:11:03+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 3</h3>\n</div>"}]}},{"text":"val df3 = List((\"Flour\", \"4 cups\"), (\"Milk\", \"1 cup\"), (\"Eggs\", \"2 large\"), (\"Spam\", \"1 can\")).toDF(\"Ingredient\", \"Amount\")\ndf3.show","user":"anonymous","dateUpdated":"2018-08-30T11:07:13+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605023_1621574159","id":"20180830-090808_1139241772","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1542","dateFinished":"2018-08-30T11:07:14+0200","dateStarted":"2018-08-30T11:07:13+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.DataFrame = [Ingredient: string, Amount: string]\n+----------+-------+\n|Ingredient| Amount|\n+----------+-------+\n|     Flour| 4 cups|\n|      Milk|  1 cup|\n|      Eggs|2 large|\n|      Spam|  1 can|\n+----------+-------+\n\n"}]}},{"text":"%md\n### Exercise 4","user":"anonymous","dateUpdated":"2018-08-30T11:11:07+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605023_796132269","id":"20180830-092052_29982790","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1543","dateFinished":"2018-08-30T11:11:07+0200","dateStarted":"2018-08-30T11:11:07+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 4</h3>\n</div>"}]}},{"text":"val df4 = spark.read.format(\"csv\").option(\"header\", \"true\").option(\"InferSchema\", \"true\").load(\"./data/winemag-data_first150k.csv\").withColumnRenamed(\"_c0\", \"index\")\ndf4.show(5)","user":"anonymous","dateUpdated":"2018-08-30T11:07:17+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605024_572543711","id":"20180830-092514_1552103952","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1544","dateFinished":"2018-08-30T11:07:21+0200","dateStarted":"2018-08-30T11:07:17+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df4: org.apache.spark.sql.DataFrame = [index: string, country: string ... 9 more fields]\n+-----+-------+--------------------+--------------------+------+-----+--------------+-----------------+-----------------+------------------+--------------------+\n|index|country|         description|         designation|points|price|      province|         region_1|         region_2|           variety|              winery|\n+-----+-------+--------------------+--------------------+------+-----+--------------+-----------------+-----------------+------------------+--------------------+\n|    0|     US|This tremendous 1...|   Martha's Vineyard|    96|235.0|    California|      Napa Valley|             Napa|Cabernet Sauvignon|               Heitz|\n|    1|  Spain|Ripe aromas of fi...|Carodorum Selecci...|    96|110.0|Northern Spain|             Toro|             null|     Tinta de Toro|Bodega Carmen Rod...|\n|    2|     US|Mac Watson honors...|Special Selected ...|    96| 90.0|    California|   Knights Valley|           Sonoma|   Sauvignon Blanc|            Macauley|\n|    3|     US|This spent 20 mon...|             Reserve|    96| 65.0|        Oregon|Willamette Valley|Willamette Valley|        Pinot Noir|               Ponzi|\n|    4| France|This is the top w...|          La Brûlade|    95| 66.0|      Provence|           Bandol|             null|Provence red blend|Domaine de la Bégude|\n+-----+-------+--------------------+--------------------+------+-----+--------------+-----------------+-----------------+------------------+--------------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=8","http://130.238.183.42:4040/jobs/job?id=9","http://130.238.183.42:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 5","user":"anonymous","dateUpdated":"2018-08-30T11:11:21+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605024_-1620917266","id":"20180830-092648_1362477890","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1545","dateFinished":"2018-08-30T11:11:21+0200","dateStarted":"2018-08-30T11:11:21+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 5</h3>\n</div>"}]}},{"text":"// Dependency issues, incompatible Jackson version.\n\n//val df5 = spark.read.format(\"com.crealytics.spark.excel\").option(\"sheetName\", \"Pregnant Women Participating\").option(\"useHeader\", \"true\").load(\"./data/WICAgencies2014ytd.xls\")\n//df5.show(5)","user":"anonymous","dateUpdated":"2018-08-30T10:58:59+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605025_1764319518","id":"20180830-093255_1979364961","dateCreated":"2018-08-30T10:43:25+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1546"},{"text":"%md\n### Exercise 6","user":"anonymous","dateUpdated":"2018-08-30T11:11:17+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605025_627734240","id":"20180830-094319_444571241","dateCreated":"2018-08-30T10:43:25+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1547","dateFinished":"2018-08-30T11:11:18+0200","dateStarted":"2018-08-30T11:11:17+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 6</h3>\n</div>"}]}},{"text":"val df6 = List((1, 12, 22), (2, 20, 19)).toDF(\"Year\", \"Cows\", \"Goats\")\ndf6.show\ndf6.write.mode(\"overwrite\").csv(\"cows_and_goats\")","user":"anonymous","dateUpdated":"2018-08-30T11:07:23+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605026_-1463203037","id":"20180830-095518_1154235382","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-08-30T11:07:23+0200","dateFinished":"2018-08-30T11:07:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1548","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df6: org.apache.spark.sql.DataFrame = [Year: int, Cows: int ... 1 more field]\n+----+----+-----+\n|Year|Cows|Goats|\n+----+----+-----+\n|   1|  12|   22|\n|   2|  20|   19|\n+----+----+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=11"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 7","user":"anonymous","dateUpdated":"2018-08-30T11:11:27+0200","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535618605027_1142635685","id":"20180830-095948_794395156","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-08-30T11:11:27+0200","dateFinished":"2018-08-30T11:11:27+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1549","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 7</h3>\n</div>"}]}},{"text":"val df7 = spark.read.format(\"jdbc\").option(\"url\", \"jdbc:sqlite:./data/database.sqlite\").option(\"dbtable\", \"artists\").load()\ndf7.show(5)","user":"anonymous","dateUpdated":"2018-08-30T11:06:12+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535619019289_1814623984","id":"20180830-105019_591252019","dateCreated":"2018-08-30T10:50:19+0200","dateStarted":"2018-08-30T11:06:12+0200","dateFinished":"2018-08-30T11:06:13+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1550","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df7: org.apache.spark.sql.DataFrame = [reviewid: int, artist: string]\n+--------+--------------+\n|reviewid|        artist|\n+--------+--------------+\n|   22703|massive attack|\n|   22721|      krallice|\n|   22659|  uranium club|\n|   22661|       kleenex|\n|   22661|       liliput|\n+--------+--------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=7"],"interpreterSettingId":"spark"}}},{"user":"anonymous","dateUpdated":"2018-08-30T11:40:56+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535619371554_2013120795","id":"20180830-105611_76435209","dateCreated":"2018-08-30T10:56:11+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1551","dateFinished":"2018-08-30T11:40:56+0200","dateStarted":"2018-08-30T11:40:56+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Indexing, selecting, and assigning</h2>\n</div>"}]},"text":"%md\n## Indexing, selecting, and assigning"},{"text":"import org.apache.spark.sql.types._\n\nval reviews = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(\"./data/winemag-data-130k-v2.csv\").withColumnRenamed(\"_c0\", \"index\").withColumn(\"index\", $\"index\".cast(IntegerType))\nreviews.show(5)","user":"anonymous","dateUpdated":"2018-08-30T14:19:43+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535622083792_-1669910764","id":"20180830-114123_1367874949","dateCreated":"2018-08-30T11:41:23+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4281","dateFinished":"2018-08-30T14:19:46+0200","dateStarted":"2018-08-30T14:19:43+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nreviews: org.apache.spark.sql.DataFrame = [index: int, country: string ... 12 more fields]\n+-----+--------+--------------------+--------------------+------+-----+-----------------+-------------------+-----------------+------------------+---------------------+--------------------+--------------+-------------------+\n|index| country|         description|         designation|points|price|         province|           region_1|         region_2|       taster_name|taster_twitter_handle|               title|       variety|             winery|\n+-----+--------+--------------------+--------------------+------+-----+-----------------+-------------------+-----------------+------------------+---------------------+--------------------+--------------+-------------------+\n|    0|   Italy|Aromas include tr...|        Vulkà Bianco|    87| null|Sicily & Sardinia|               Etna|             null|     Kerin O’Keefe|         @kerinokeefe|Nicosia 2013 Vulk...|   White Blend|            Nicosia|\n|    1|Portugal|This is ripe and ...|            Avidagos|    87| 15.0|            Douro|               null|             null|        Roger Voss|           @vossroger|Quinta dos Avidag...|Portuguese Red|Quinta dos Avidagos|\n|    2|      US|Tart and snappy, ...|                null|    87| 14.0|           Oregon|  Willamette Valley|Willamette Valley|      Paul Gregutt|          @paulgwine |Rainstorm 2013 Pi...|    Pinot Gris|          Rainstorm|\n|    3|      US|Pineapple rind, l...|Reserve Late Harvest|    87| 13.0|         Michigan|Lake Michigan Shore|             null|Alexander Peartree|                 null|St. Julian 2013 R...|      Riesling|         St. Julian|\n|    4|      US|Much like the reg...|Vintner's Reserve...|    87| 65.0|           Oregon|  Willamette Valley|Willamette Valley|      Paul Gregutt|          @paulgwine |Sweet Cheeks 2012...|    Pinot Noir|       Sweet Cheeks|\n+-----+--------+--------------------+--------------------+------+-----+-----------------+-------------------+-----------------+------------------+---------------------+--------------------+--------------+-------------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=163","http://130.238.183.42:4040/jobs/job?id=164","http://130.238.183.42:4040/jobs/job?id=165"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 1","user":"anonymous","dateUpdated":"2018-08-30T11:40:58+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535620301217_-1024789498","id":"20180830-111141_1609124681","dateCreated":"2018-08-30T11:11:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3964","dateFinished":"2018-08-30T11:40:58+0200","dateStarted":"2018-08-30T11:40:58+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 1</h3>\n</div>"}]}},{"text":"val df1 = reviews.select(\"description\")","user":"anonymous","dateUpdated":"2018-08-30T11:53:47+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535620317727_412953340","id":"20180830-111157_279230631","dateCreated":"2018-08-30T11:11:57+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4060","dateFinished":"2018-08-30T11:53:47+0200","dateStarted":"2018-08-30T11:53:47+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [description: string]\n"}]}},{"text":"%md\n### Exercise 2","user":"anonymous","dateUpdated":"2018-08-30T11:46:20+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535620556753_1049504296","id":"20180830-111556_1080956798","dateCreated":"2018-08-30T11:15:56+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4137","dateFinished":"2018-08-30T11:46:20+0200","dateStarted":"2018-08-30T11:46:20+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 2</h3>\n</div>"}]}},{"text":"val df2 = df1.take(1)","user":"anonymous","dateUpdated":"2018-08-30T11:58:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535622380561_-865258728","id":"20180830-114620_795061568","dateCreated":"2018-08-30T11:46:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4810","dateFinished":"2018-08-30T11:58:38+0200","dateStarted":"2018-08-30T11:58:37+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: Array[org.apache.spark.sql.Row] = Array([Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=33"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535622396253_683939018","id":"20180830-114636_638926655","dateCreated":"2018-08-30T11:46:36+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4899","text":"%md\n### Exercise 3","dateUpdated":"2018-08-30T11:58:51+0200","dateFinished":"2018-08-30T11:58:51+0200","dateStarted":"2018-08-30T11:58:51+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 3</h3>\n</div>"}]}},{"text":"val df3 = reviews.filter($\"index\" === 0)","user":"anonymous","dateUpdated":"2018-08-30T11:59:58+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535623131354_-1715691410","id":"20180830-115851_1002494007","dateCreated":"2018-08-30T11:58:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5449","dateFinished":"2018-08-30T11:59:58+0200","dateStarted":"2018-08-30T11:59:58+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: string, country: string ... 12 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535623175234_729209495","id":"20180830-115935_1572820398","dateCreated":"2018-08-30T11:59:35+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5538","text":"%md\n### Exercise 4","dateUpdated":"2018-08-30T12:03:59+0200","dateFinished":"2018-08-30T12:03:59+0200","dateStarted":"2018-08-30T12:03:59+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 4</h3>\n</div>"}]}},{"text":"val df4 = reviews.select(\"description\").take(10)","user":"anonymous","dateUpdated":"2018-08-30T12:04:21+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535623439250_-1959464324","id":"20180830-120359_1300345181","dateCreated":"2018-08-30T12:03:59+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5692","dateFinished":"2018-08-30T12:04:22+0200","dateStarted":"2018-08-30T12:04:21+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df4: Array[org.apache.spark.sql.Row] = Array([Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.], [This is ripe and fruity, a wine that is smooth while still structured. Firm tannins are filled out with juicy red berry fruits and freshened with acidity. It's  already drinkable, although it will certainly be better from 2016.], [Tart and snappy, the flavors of lime flesh and rind dominate. Some green pineapple pokes through, with crisp acidity underscoring the flavors. The wine was all stainless-steel fermented.], [Pineapple rind, lemon pith and orange blossom start off the aromas. The palate is a bit more opulent, with notes of honey-drizzled guava and mango giving ..."}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=35"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535623461804_182027163","id":"20180830-120421_441986797","dateCreated":"2018-08-30T12:04:21+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5781","text":"%md\n### Exercise 5","dateUpdated":"2018-08-30T12:04:45+0200","dateFinished":"2018-08-30T12:04:45+0200","dateStarted":"2018-08-30T12:04:45+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 5</h3>\n</div>"}]}},{"text":"val df5 = reviews.filter($\"index\" isin (\"1\",\"2\",\"3\",\"5\",\"8\"))\ndf5.show","user":"anonymous","dateUpdated":"2018-08-30T12:33:44+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535623485067_1606212351","id":"20180830-120445_1855436585","dateCreated":"2018-08-30T12:04:45+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5897","dateFinished":"2018-08-30T12:33:45+0200","dateStarted":"2018-08-30T12:33:44+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df5: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: string, country: string ... 12 more fields]\n+-----+--------+--------------------+--------------------+------+-----+--------------+-------------------+-----------------+------------------+---------------------+--------------------+------------------+-------------------+\n|index| country|         description|         designation|points|price|      province|           region_1|         region_2|       taster_name|taster_twitter_handle|               title|           variety|             winery|\n+-----+--------+--------------------+--------------------+------+-----+--------------+-------------------+-----------------+------------------+---------------------+--------------------+------------------+-------------------+\n|    1|Portugal|This is ripe and ...|            Avidagos|    87| 15.0|         Douro|               null|             null|        Roger Voss|           @vossroger|Quinta dos Avidag...|    Portuguese Red|Quinta dos Avidagos|\n|    2|      US|Tart and snappy, ...|                null|    87| 14.0|        Oregon|  Willamette Valley|Willamette Valley|      Paul Gregutt|          @paulgwine |Rainstorm 2013 Pi...|        Pinot Gris|          Rainstorm|\n|    3|      US|Pineapple rind, l...|Reserve Late Harvest|    87| 13.0|      Michigan|Lake Michigan Shore|             null|Alexander Peartree|                 null|St. Julian 2013 R...|          Riesling|         St. Julian|\n|    5|   Spain|Blackberry and ra...|        Ars In Vitro|    87| 15.0|Northern Spain|            Navarra|             null| Michael Schachner|          @wineschach|Tandem 2011 Ars I...|Tempranillo-Merlot|             Tandem|\n|    8| Germany|Savory dried thym...|               Shine|    87| 12.0|   Rheinhessen|               null|             null|Anna Lee C. Iijima|                 null|Heinz Eifel 2013 ...|    Gewürztraminer|        Heinz Eifel|\n+-----+--------+--------------------+--------------------+------+-----+--------------+-------------------+-----------------+------------------+---------------------+--------------------+------------------+-------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=36","http://130.238.183.42:4040/jobs/job?id=37"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535623623778_-1781483497","id":"20180830-120703_1058118667","dateCreated":"2018-08-30T12:07:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5986","text":"%md\n### Exercise 6","dateUpdated":"2018-08-30T12:35:23+0200","dateFinished":"2018-08-30T12:35:23+0200","dateStarted":"2018-08-30T12:35:23+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 6</h3>\n</div>"}]}},{"text":"val df6 = reviews.filter($\"index\".cast(IntegerType) isin (0,1,10,100)).select(\"country\", \"province\", \"region_1\", \"region_2\")\ndf6.show","user":"anonymous","dateUpdated":"2018-08-30T13:02:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535625323737_1521675682","id":"20180830-123523_1168126640","dateCreated":"2018-08-30T12:35:23+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6372","dateFinished":"2018-08-30T12:51:06+0200","dateStarted":"2018-08-30T12:51:05+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\ndf6: org.apache.spark.sql.DataFrame = [country: string, province: string ... 2 more fields]\n+--------+-----------------+------------+------------+\n| country|         province|    region_1|    region_2|\n+--------+-----------------+------------+------------+\n|   Italy|Sicily & Sardinia|        Etna|        null|\n|Portugal|            Douro|        null|        null|\n|      US|       California| Napa Valley|        Napa|\n|      US|         New York|Finger Lakes|Finger Lakes|\n+--------+-----------------+------------+------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=46","http://130.238.183.42:4040/jobs/job?id=47"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627033451_1424107292","id":"20180830-130353_1075926751","dateCreated":"2018-08-30T13:03:53+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7741","text":"%md\n### Exercise 7","dateUpdated":"2018-08-30T13:03:59+0200","dateFinished":"2018-08-30T13:03:59+0200","dateStarted":"2018-08-30T13:03:59+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 7</h3>\n</div>"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535625394658_1410140095","id":"20180830-123634_807562426","dateCreated":"2018-08-30T12:36:34+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6461","text":"val df7 = reviews.filter($\"index\".cast(IntegerType) < 100).select(\"country\", \"variety\")\ndf7.count","dateUpdated":"2018-08-30T13:03:43+0200","dateFinished":"2018-08-30T13:03:45+0200","dateStarted":"2018-08-30T13:03:43+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df7: org.apache.spark.sql.DataFrame = [country: string, variety: string]\nres128: Long = 100\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=53"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627041040_1120400735","id":"20180830-130401_1236413169","dateCreated":"2018-08-30T13:04:01+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7831","text":"%md\n### Exercise 8","dateUpdated":"2018-08-30T13:04:07+0200","dateFinished":"2018-08-30T13:04:07+0200","dateStarted":"2018-08-30T13:04:07+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 8</h3>\n</div>"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535625465618_-1828261483","id":"20180830-123745_1054907318","dateCreated":"2018-08-30T12:37:45+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6596","text":"val df8 = reviews.filter($\"country\" === \"Italy\")\ndf8.show(5)","dateUpdated":"2018-08-30T13:04:43+0200","dateFinished":"2018-08-30T13:04:44+0200","dateStarted":"2018-08-30T13:04:43+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df8: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: string, country: string ... 12 more fields]\n+-----+-------+--------------------+------------+------+-----+-----------------+--------+--------+-------------+---------------------+--------------------+-----------------+-------------------+\n|index|country|         description| designation|points|price|         province|region_1|region_2|  taster_name|taster_twitter_handle|               title|          variety|             winery|\n+-----+-------+--------------------+------------+------+-----+-----------------+--------+--------+-------------+---------------------+--------------------+-----------------+-------------------+\n|    0|  Italy|Aromas include tr...|Vulkà Bianco|    87| null|Sicily & Sardinia|    Etna|    null|Kerin O’Keefe|         @kerinokeefe|Nicosia 2013 Vulk...|      White Blend|            Nicosia|\n|    6|  Italy|Here's a bright, ...|     Belsito|    87| 16.0|Sicily & Sardinia|Vittoria|    null|Kerin O’Keefe|         @kerinokeefe|Terre di Giurfo 2...|         Frappato|    Terre di Giurfo|\n|   13|  Italy|This is dominated...|       Rosso|    87| null|Sicily & Sardinia|    Etna|    null|Kerin O’Keefe|         @kerinokeefe|Masseria Settepor...|Nerello Mascalese|Masseria Setteporte|\n|   22|  Italy|Delicate aromas r...|   Ficiligno|    87| 19.0|Sicily & Sardinia| Sicilia|    null|Kerin O’Keefe|         @kerinokeefe|Baglio di Pianett...|      White Blend| Baglio di Pianetto|\n|   24|  Italy|Aromas of prune, ...|       Aynat|    87| 35.0|Sicily & Sardinia| Sicilia|    null|Kerin O’Keefe|         @kerinokeefe|Canicattì 2009 Ay...|     Nero d'Avola|          Canicattì|\n+-----+-------+--------------------+------------+------+-----+-----------------+--------+--------+-------------+---------------------+--------------------+-----------------+-------------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=54"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627076713_634664908","id":"20180830-130436_678259633","dateCreated":"2018-08-30T13:04:36+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7921","text":"%md\n### Exercise 9","dateUpdated":"2018-08-30T13:04:53+0200","dateFinished":"2018-08-30T13:04:53+0200","dateStarted":"2018-08-30T13:04:53+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 9</h3>\n</div>"}]}},{"text":"val df9 = reviews.filter($\"region_2\".isNotNull)\ndf9.show(5)","user":"anonymous","dateUpdated":"2018-08-30T13:06:42+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627093659_-214235058","id":"20180830-130453_1177178807","dateCreated":"2018-08-30T13:04:53+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8059","dateFinished":"2018-08-30T13:06:43+0200","dateStarted":"2018-08-30T13:06:42+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df9: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: string, country: string ... 12 more fields]\n+-----+-------+--------------------+--------------------+------+-----+----------+-----------------+-----------------+--------------+---------------------+--------------------+------------------+------------------+\n|index|country|         description|         designation|points|price|  province|         region_1|         region_2|   taster_name|taster_twitter_handle|               title|           variety|            winery|\n+-----+-------+--------------------+--------------------+------+-----+----------+-----------------+-----------------+--------------+---------------------+--------------------+------------------+------------------+\n|    2|     US|Tart and snappy, ...|                null|    87| 14.0|    Oregon|Willamette Valley|Willamette Valley|  Paul Gregutt|          @paulgwine |Rainstorm 2013 Pi...|        Pinot Gris|         Rainstorm|\n|    4|     US|Much like the reg...|Vintner's Reserve...|    87| 65.0|    Oregon|Willamette Valley|Willamette Valley|  Paul Gregutt|          @paulgwine |Sweet Cheeks 2012...|        Pinot Noir|      Sweet Cheeks|\n|   10|     US|Soft, supple plum...|      Mountain Cuvée|    87| 19.0|California|      Napa Valley|             Napa|Virginie Boone|              @vboone|Kirkland Signatur...|Cabernet Sauvignon|Kirkland Signature|\n|   12|     US|Slightly reduced,...|                null|    87| 34.0|California| Alexander Valley|           Sonoma|Virginie Boone|              @vboone|Louis M. Martini ...|Cabernet Sauvignon|  Louis M. Martini|\n|   14|     US|Building on 150 y...|                null|    87| 12.0|California|    Central Coast|    Central Coast| Matt Kettmann|        @mattkettmann|Mirassou 2012 Cha...|        Chardonnay|          Mirassou|\n+-----+-------+--------------------+--------------------+------+-----+----------+-----------------+-----------------+--------------+---------------------+--------------------+------------------+------------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=55"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627154442_723805733","id":"20180830-130554_1928933189","dateCreated":"2018-08-30T13:05:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8148","text":"%md\n### Exercise 10","dateUpdated":"2018-08-30T13:07:15+0200","dateFinished":"2018-08-30T13:07:15+0200","dateStarted":"2018-08-30T13:07:15+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 10</h3>\n</div>"}]}},{"text":"val df10 = reviews.withColumn(\"points\", $\"points\".cast(IntegerType))\ndf10.printSchema\ndf10.createOrReplaceTempView(\"temp\")\n","user":"anonymous","dateUpdated":"2018-08-30T14:19:54+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627235659_-1328189711","id":"20180830-130715_982554348","dateCreated":"2018-08-30T13:07:15+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8302","dateFinished":"2018-08-30T14:19:55+0200","dateStarted":"2018-08-30T14:19:54+0200","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df10: org.apache.spark.sql.DataFrame = [index: int, country: string ... 12 more fields]\nroot\n |-- index: integer (nullable = true)\n |-- country: string (nullable = true)\n |-- description: string (nullable = true)\n |-- designation: string (nullable = true)\n |-- points: integer (nullable = true)\n |-- price: string (nullable = true)\n |-- province: string (nullable = true)\n |-- region_1: string (nullable = true)\n |-- region_2: string (nullable = true)\n |-- taster_name: string (nullable = true)\n |-- taster_twitter_handle: string (nullable = true)\n |-- title: string (nullable = true)\n |-- variety: string (nullable = true)\n |-- winery: string (nullable = true)\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","n":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627262666_667956540","id":"20180830-130742_1241753705","dateCreated":"2018-08-30T13:07:42+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8391","text":"%sql\nselect points, count(*) as n from temp group by points","dateUpdated":"2018-08-30T14:20:02+0200","dateFinished":"2018-08-30T14:20:02+0200","dateStarted":"2018-08-30T14:20:00+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n85\t9529\n81\t692\n91\t11358\n93\t6484\nnull\t27\n86\t12598\n94\t3757\n96\t523\n92\t9610\n88\t17203\n100\t19\n84\t6479\n87\t16931\n97\t229\n82\t1836\n80\t397\n95\t1535\n98\t77\n90\t15407\n83\t3025\n71\t1\n99\t33\n89\t12222\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=166","http://130.238.183.42:4040/jobs/job?id=167","http://130.238.183.42:4040/jobs/job?id=168","http://130.238.183.42:4040/jobs/job?id=169","http://130.238.183.42:4040/jobs/job?id=170"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 11","user":"anonymous","dateUpdated":"2018-08-30T13:21:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535628082145_-1259000378","id":"20180830-132122_1138239320","dateCreated":"2018-08-30T13:21:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18148","dateFinished":"2018-08-30T13:21:34+0200","dateStarted":"2018-08-30T13:21:34+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 11</h3>\n</div>"}]}},{"text":"%sql\nselect points, count(*) as n from (select * from temp limit 1000) group by points","user":"anonymous","dateUpdated":"2018-08-30T14:20:05+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","n":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627311869_-1471615944","id":"20180830-130831_1145391524","dateCreated":"2018-08-30T13:08:31+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8488","dateFinished":"2018-08-30T14:20:05+0200","dateStarted":"2018-08-30T14:20:04+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n87\t221\n86\t103\n85\t110\n88\t74\n92\t95\n91\t102\n90\t155\n89\t80\n83\t2\n82\t5\n81\t1\n80\t1\n100\t1\n98\t1\n97\t4\n96\t5\n95\t10\n93\t30\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=171"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 12","user":"anonymous","dateUpdated":"2018-08-30T13:27:20+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535628432561_-929393196","id":"20180830-132712_179544260","dateCreated":"2018-08-30T13:27:12+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23561","dateFinished":"2018-08-30T13:27:20+0200","dateStarted":"2018-08-30T13:27:20+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 12</h3>\n</div>"}]}},{"text":"%sql\nselect points, count(*) as n from (select * from temp order by index desc limit 1000) group by points","user":"anonymous","dateUpdated":"2018-08-30T14:20:09+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535627515203_1346076538","id":"20180830-131155_2015072453","dateCreated":"2018-08-30T13:11:55+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10037","dateFinished":"2018-08-30T14:20:08+0200","dateStarted":"2018-08-30T14:20:07+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n90\t212\n91\t82\n92\t32\n86\t81\n88\t99\n89\t85\n87\t184\n93\t148\n84\t53\n85\t24\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=172"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 13","user":"anonymous","dateUpdated":"2018-08-30T14:20:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"index":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535629923850_273344976","id":"20180830-135203_643686101","dateCreated":"2018-08-30T13:52:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30701","dateFinished":"2018-08-30T14:20:37+0200","dateStarted":"2018-08-30T14:20:37+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 13</h3>\n</div>"}]}},{"text":"%sql\nselect points, count(*) as n from temp where country = \"Italy\" group by points","user":"anonymous","dateUpdated":"2018-08-30T14:22:29+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535628588763_-1695042615","id":"20180830-132948_1690321377","dateCreated":"2018-08-30T13:29:48+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:23979","dateFinished":"2018-08-30T14:22:21+0200","dateStarted":"2018-08-30T14:22:20+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n85\t1145\n81\t20\n91\t1351\n93\t846\nnull\t4\n86\t2067\n94\t494\n96\t63\n92\t1226\n88\t3103\n100\t4\n84\t560\n87\t3442\n97\t43\n82\t69\n80\t5\n95\t215\n98\t12\n90\t2382\n83\t206\n99\t9\n89\t2274\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=178","http://130.238.183.42:4040/jobs/job?id=179","http://130.238.183.42:4040/jobs/job?id=180","http://130.238.183.42:4040/jobs/job?id=181","http://130.238.183.42:4040/jobs/job?id=182"],"interpreterSettingId":"spark"}}},{"text":"%md\n### Exercise 14","user":"anonymous","dateUpdated":"2018-08-30T14:21:36+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535629610164_-1561389444","id":"20180830-134650_663215352","dateCreated":"2018-08-30T13:46:50+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:27582","dateFinished":"2018-08-30T14:21:36+0200","dateStarted":"2018-08-30T14:21:36+0200","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 14</h3>\n</div>"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","n":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535629797411_-3236335","id":"20180830-134957_738273721","dateCreated":"2018-08-30T13:49:57+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:30493","text":"%sql\nselect country, count(*) as n from temp where country = \"Italy\" and points >= 90 or country = \"France\" and points >= 90 group by country","dateUpdated":"2018-08-30T14:26:09+0200","dateFinished":"2018-08-30T14:26:09+0200","dateStarted":"2018-08-30T14:26:07+0200","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country\tn\nFrance\t9192\nItaly\t6645\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://130.238.183.42:4040/jobs/job?id=196","http://130.238.183.42:4040/jobs/job?id=197","http://130.238.183.42:4040/jobs/job?id=198","http://130.238.183.42:4040/jobs/job?id=199","http://130.238.183.42:4040/jobs/job?id=200"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1535631775002_2057441260","id":"20180830-142255_785892508","dateCreated":"2018-08-30T14:22:55+0200","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:34354"}],"name":"dataframe","id":"2DR7EVDR9","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}