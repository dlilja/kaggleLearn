{"paragraphs":[{"text":"%md\n# Kaggle Pandas Course\n\nThis notebook covers reasonable Apache Spark translations of my solutions to the Kaggle Learn course on Pandas. It requires the package `org.xerial.sqlite-jdbc.3.23.1` for one of the solutions and `python`'s `seaborn` package for making a number of plots. It also assumes that the required data are in a folder called `data` inside the working directory of the notebook. Also note that the data provided by Kaggle for the exercises is not formatted for unix-like operating systems.","user":"anonymous","dateUpdated":"2018-09-03T21:13:20+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Kaggle Pandas Course</h1>\n<p>This notebook covers reasonable Apache Spark translations of my solutions to the Kaggle Learn course on Pandas. It requires the package <code>org.xerial.sqlite-jdbc.3.23.1</code> for one of the solutions and <code>python</code>&rsquo;s <code>seaborn</code> package for making a number of plots. It also assumes that the required data are in a folder called <code>data</code> inside the working directory of the notebook. Also note that the data provided by Kaggle for the exercises is not formatted for unix-like operating systems.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1535620217071_-1660801626","id":"20180830-111017_917175274","dateCreated":"2018-08-30T11:10:17+0200","dateStarted":"2018-09-03T21:13:20+0200","dateFinished":"2018-09-03T21:13:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:185"},{"text":"%md\n## Creating, reading and writing","user":"anonymous","dateUpdated":"2018-09-03T21:08:04+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Creating, reading and writing</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605016_870892530","id":"20180829-220202_102300628","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:04+0200","dateFinished":"2018-09-03T21:08:04+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:186"},{"text":"%md\n### Exercise 1","user":"anonymous","dateUpdated":"2018-09-03T21:08:04+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 1</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605020_-2076743434","id":"20180830-085255_623319210","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:04+0200","dateFinished":"2018-09-03T21:08:04+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:187"},{"text":"val df1 = List((30, 21)).toDF(\"Apples\", \"Bananas\")\ndf1.show","user":"anonymous","dateUpdated":"2018-09-03T21:08:05+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [Apples: int, Bananas: int]\n+------+-------+\n|Apples|Bananas|\n+------+-------+\n|    30|     21|\n+------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1535618605021_133763979","id":"20180829-220243_767502813","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:05+0200","dateFinished":"2018-09-03T21:08:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:188"},{"text":"%md\n### Exercise 2","user":"anonymous","dateUpdated":"2018-09-03T21:08:10+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 2</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605021_468272944","id":"20180829-220748_348946599","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:10+0200","dateFinished":"2018-09-03T21:08:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:189"},{"text":"val df2 = List((\"2017 Sales\", 35, 32), (\"2018 Sales\", 41, 34)).toDF(\"Index\", \"Apples\", \"Bananas\")\ndf2.show","user":"anonymous","dateUpdated":"2018-09-03T21:08:10+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [Index: string, Apples: int ... 1 more field]\n+----------+------+-------+\n|     Index|Apples|Bananas|\n+----------+------+-------+\n|2017 Sales|    35|     32|\n|2018 Sales|    41|     34|\n+----------+------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1535618605022_897494645","id":"20180830-085311_558322596","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:11+0200","dateFinished":"2018-09-03T21:08:12+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:190"},{"text":"%md\n### Exercise 3","user":"anonymous","dateUpdated":"2018-09-03T21:08:12+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 3</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605022_-1531546187","id":"20180830-090717_637949266","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:13+0200","dateFinished":"2018-09-03T21:08:13+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:191"},{"text":"val df3 = List((\"Flour\", \"4 cups\"), (\"Milk\", \"1 cup\"), (\"Eggs\", \"2 large\"), (\"Spam\", \"1 can\")).toDF(\"Ingredient\", \"Amount\")\ndf3.show","user":"anonymous","dateUpdated":"2018-09-03T21:08:13+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.DataFrame = [Ingredient: string, Amount: string]\n+----------+-------+\n|Ingredient| Amount|\n+----------+-------+\n|     Flour| 4 cups|\n|      Milk|  1 cup|\n|      Eggs|2 large|\n|      Spam|  1 can|\n+----------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1535618605023_1621574159","id":"20180830-090808_1139241772","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:13+0200","dateFinished":"2018-09-03T21:08:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:192"},{"text":"%md\n### Exercise 4","user":"anonymous","dateUpdated":"2018-09-03T21:08:14+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 4</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605023_796132269","id":"20180830-092052_29982790","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:14+0200","dateFinished":"2018-09-03T21:08:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:193"},{"text":"val df4 = spark.read.format(\"csv\").option(\"header\", \"true\").option(\"InferSchema\", \"true\").load(\"./data/winemag-data_first150k.csv\").withColumnRenamed(\"_c0\", \"index\")\ndf4.show(5)","user":"anonymous","dateUpdated":"2018-09-03T21:08:15+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df4: org.apache.spark.sql.DataFrame = [index: string, country: string ... 9 more fields]\n+-----+-------+--------------------+--------------------+------+-----+--------------+-----------------+-----------------+------------------+--------------------+\n|index|country|         description|         designation|points|price|      province|         region_1|         region_2|           variety|              winery|\n+-----+-------+--------------------+--------------------+------+-----+--------------+-----------------+-----------------+------------------+--------------------+\n|    0|     US|This tremendous 1...|   Martha's Vineyard|    96|235.0|    California|      Napa Valley|             Napa|Cabernet Sauvignon|               Heitz|\n|    1|  Spain|Ripe aromas of fi...|Carodorum Selecci...|    96|110.0|Northern Spain|             Toro|             null|     Tinta de Toro|Bodega Carmen Rod...|\n|    2|     US|Mac Watson honors...|Special Selected ...|    96| 90.0|    California|   Knights Valley|           Sonoma|   Sauvignon Blanc|            Macauley|\n|    3|     US|This spent 20 mon...|             Reserve|    96| 65.0|        Oregon|Willamette Valley|Willamette Valley|        Pinot Noir|               Ponzi|\n|    4| France|This is the top w...|          La Brûlade|    95| 66.0|      Provence|           Bandol|             null|Provence red blend|Domaine de la Bégude|\n+-----+-------+--------------------+--------------------+------+-----+--------------+-----------------+-----------------+------------------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535618605024_572543711","id":"20180830-092514_1552103952","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:15+0200","dateFinished":"2018-09-03T21:08:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:194"},{"text":"%md\n### Exercise 5","user":"anonymous","dateUpdated":"2018-09-03T21:08:19+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 5</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605024_-1620917266","id":"20180830-092648_1362477890","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:19+0200","dateFinished":"2018-09-03T21:08:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:195"},{"text":"// Dependency issues, incompatible Jackson version.\n\n//val df5 = spark.read.format(\"com.crealytics.spark.excel\").option(\"sheetName\", \"Pregnant Women Participating\").option(\"useHeader\", \"true\").load(\"./data/WICAgencies2014ytd.xls\")\n//df5.show(5)","user":"anonymous","dateUpdated":"2018-09-03T21:08:19+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1535618605025_1764319518","id":"20180830-093255_1979364961","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:19+0200","dateFinished":"2018-09-03T21:08:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:196"},{"text":"%md\n### Exercise 6","user":"anonymous","dateUpdated":"2018-09-03T21:08:20+0200","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 6</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605025_627734240","id":"20180830-094319_444571241","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:20+0200","dateFinished":"2018-09-03T21:08:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:197"},{"text":"val df6 = List((1, 12, 22), (2, 20, 19)).toDF(\"Year\", \"Cows\", \"Goats\")\ndf6.show\ndf6.write.mode(\"overwrite\").csv(\"cows_and_goats\")","user":"anonymous","dateUpdated":"2018-09-03T21:08:20+0200","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df6: org.apache.spark.sql.DataFrame = [Year: int, Cows: int ... 1 more field]\n+----+----+-----+\n|Year|Cows|Goats|\n+----+----+-----+\n|   1|  12|   22|\n|   2|  20|   19|\n+----+----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1535618605026_-1463203037","id":"20180830-095518_1154235382","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:20+0200","dateFinished":"2018-09-03T21:08:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:198"},{"text":"%md\n### Exercise 7","user":"anonymous","dateUpdated":"2018-09-03T21:08:22+0200","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 7</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535618605027_1142635685","id":"20180830-095948_794395156","dateCreated":"2018-08-30T10:43:25+0200","dateStarted":"2018-09-03T21:08:22+0200","dateFinished":"2018-09-03T21:08:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:199"},{"text":"val df7 = spark.read.format(\"jdbc\").option(\"url\", \"jdbc:sqlite:./data/database.sqlite\").option(\"dbtable\", \"artists\").load()\ndf7.show(5)","user":"anonymous","dateUpdated":"2018-09-03T21:08:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df7: org.apache.spark.sql.DataFrame = [reviewid: int, artist: string]\n+--------+--------------+\n|reviewid|        artist|\n+--------+--------------+\n|   22703|massive attack|\n|   22721|      krallice|\n|   22659|  uranium club|\n|   22661|       kleenex|\n|   22661|       liliput|\n+--------+--------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535619019289_1814623984","id":"20180830-105019_591252019","dateCreated":"2018-08-30T10:50:19+0200","dateStarted":"2018-09-03T21:08:22+0200","dateFinished":"2018-09-03T21:08:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:200"},{"text":"%md\n## Indexing, selecting, and assigning","user":"anonymous","dateUpdated":"2018-09-03T21:08:24+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Indexing, selecting, and assigning</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1535619371554_2013120795","id":"20180830-105611_76435209","dateCreated":"2018-08-30T10:56:11+0200","dateStarted":"2018-09-03T21:08:24+0200","dateFinished":"2018-09-03T21:08:24+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:201"},{"text":"// Gotcha: Spark doesn't follow the RFC-4180 standard for CSV file formatting, hence plenty of commas inside strings are interpreted as field delimiters when they shouldn't be. \n// This is fixed using .option(\"quotes\", \"\\\"\").option(\"escape\", \"\\\"\").\n\nimport org.apache.spark.sql.types._\n\nval reviews = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\").option(\"quotes\", \"\\\"\").option(\"escape\", \"\\\"\").csv(\"./data/winemag-data-130k-v2.csv\").withColumnRenamed(\"_c0\", \"index\").withColumn(\"index\", $\"index\".cast(IntegerType)).withColumn(\"price\", $\"price\".cast(DoubleType))\nreviews.show(5)","user":"anonymous","dateUpdated":"2018-09-03T23:31:08+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nreviews: org.apache.spark.sql.DataFrame = [index: int, country: string ... 12 more fields]\n+-----+--------+--------------------+--------------------+------+-----+-----------------+-------------------+-----------------+------------------+---------------------+--------------------+--------------+-------------------+\n|index| country|         description|         designation|points|price|         province|           region_1|         region_2|       taster_name|taster_twitter_handle|               title|       variety|             winery|\n+-----+--------+--------------------+--------------------+------+-----+-----------------+-------------------+-----------------+------------------+---------------------+--------------------+--------------+-------------------+\n|    0|   Italy|Aromas include tr...|        Vulkà Bianco|  87.0| null|Sicily & Sardinia|               Etna|             null|     Kerin O’Keefe|         @kerinokeefe|Nicosia 2013 Vulk...|   White Blend|            Nicosia|\n|    1|Portugal|This is ripe and ...|            Avidagos|  87.0| 15.0|            Douro|               null|             null|        Roger Voss|           @vossroger|Quinta dos Avidag...|Portuguese Red|Quinta dos Avidagos|\n|    2|      US|Tart and snappy, ...|                null|  87.0| 14.0|           Oregon|  Willamette Valley|Willamette Valley|      Paul Gregutt|          @paulgwine |Rainstorm 2013 Pi...|    Pinot Gris|          Rainstorm|\n|    3|      US|Pineapple rind, l...|Reserve Late Harvest|  87.0| 13.0|         Michigan|Lake Michigan Shore|             null|Alexander Peartree|                 null|St. Julian 2013 R...|      Riesling|         St. Julian|\n|    4|      US|Much like the reg...|Vintner's Reserve...|  87.0| 65.0|           Oregon|  Willamette Valley|Willamette Valley|      Paul Gregutt|          @paulgwine |Sweet Cheeks 2012...|    Pinot Noir|       Sweet Cheeks|\n+-----+--------+--------------------+--------------------+------+-----+-----------------+-------------------+-----------------+------------------+---------------------+--------------------+--------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535622083792_-1669910764","id":"20180830-114123_1367874949","dateCreated":"2018-08-30T11:41:23+0200","dateStarted":"2018-09-03T23:31:08+0200","dateFinished":"2018-09-03T23:31:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:202"},{"text":"%md\n### Exercise 1","user":"anonymous","dateUpdated":"2018-09-03T21:08:27+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 1</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535620301217_-1024789498","id":"20180830-111141_1609124681","dateCreated":"2018-08-30T11:11:41+0200","dateStarted":"2018-09-03T21:08:28+0200","dateFinished":"2018-09-03T21:08:28+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203"},{"text":"val df1 = reviews.select(\"description\")","user":"anonymous","dateUpdated":"2018-09-03T21:08:28+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [description: string]\n"}]},"apps":[],"jobName":"paragraph_1535620317727_412953340","id":"20180830-111157_279230631","dateCreated":"2018-08-30T11:11:57+0200","dateStarted":"2018-09-03T21:08:28+0200","dateFinished":"2018-09-03T21:08:28+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:204"},{"text":"%md\n### Exercise 2","user":"anonymous","dateUpdated":"2018-09-03T21:08:28+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 2</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535620556753_1049504296","id":"20180830-111556_1080956798","dateCreated":"2018-08-30T11:15:56+0200","dateStarted":"2018-09-03T21:08:29+0200","dateFinished":"2018-09-03T21:08:29+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:205"},{"text":"val df2 = df1.take(1)","user":"anonymous","dateUpdated":"2018-09-03T21:08:29+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: Array[org.apache.spark.sql.Row] = Array([Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.])\n"}]},"apps":[],"jobName":"paragraph_1535622380561_-865258728","id":"20180830-114620_795061568","dateCreated":"2018-08-30T11:46:20+0200","dateStarted":"2018-09-03T21:08:29+0200","dateFinished":"2018-09-03T21:08:30+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:206"},{"text":"%md\n### Exercise 3","user":"anonymous","dateUpdated":"2018-09-03T21:08:30+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 3</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535622396253_683939018","id":"20180830-114636_638926655","dateCreated":"2018-08-30T11:46:36+0200","dateStarted":"2018-09-03T21:08:30+0200","dateFinished":"2018-09-03T21:08:30+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:207"},{"text":"val df3 = reviews.filter($\"index\" === 0)","user":"anonymous","dateUpdated":"2018-09-03T21:08:30+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: int, country: string ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1535623131354_-1715691410","id":"20180830-115851_1002494007","dateCreated":"2018-08-30T11:58:51+0200","dateStarted":"2018-09-03T21:08:30+0200","dateFinished":"2018-09-03T21:08:31+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208"},{"text":"%md\n### Exercise 4","user":"anonymous","dateUpdated":"2018-09-03T21:08:31+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 4</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535623175234_729209495","id":"20180830-115935_1572820398","dateCreated":"2018-08-30T11:59:35+0200","dateStarted":"2018-09-03T21:08:31+0200","dateFinished":"2018-09-03T21:08:31+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:209"},{"text":"val df4 = reviews.select(\"description\").take(10)","user":"anonymous","dateUpdated":"2018-09-03T21:08:31+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df4: Array[org.apache.spark.sql.Row] = Array([Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn't overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.], [This is ripe and fruity, a wine that is smooth while still structured. Firm tannins are filled out with juicy red berry fruits and freshened with acidity. It's  already drinkable, although it will certainly be better from 2016.], [Tart and snappy, the flavors of lime flesh and rind dominate. Some green pineapple pokes through, with crisp acidity underscoring the flavors. The wine was all stainless-steel fermented.], [Pineapple rind, lemon pith and orange blossom start off the aromas. The palate is a bit more opulent, with notes of honey-drizzled guava and mango giving ..."}]},"apps":[],"jobName":"paragraph_1535623439250_-1959464324","id":"20180830-120359_1300345181","dateCreated":"2018-08-30T12:03:59+0200","dateStarted":"2018-09-03T21:08:31+0200","dateFinished":"2018-09-03T21:08:32+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:210"},{"text":"%md\n### Exercise 5","user":"anonymous","dateUpdated":"2018-09-03T21:08:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 5</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535623461804_182027163","id":"20180830-120421_441986797","dateCreated":"2018-08-30T12:04:21+0200","dateStarted":"2018-09-03T21:08:33+0200","dateFinished":"2018-09-03T21:08:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:211"},{"text":"val df5 = reviews.filter($\"index\" isin (\"1\",\"2\",\"3\",\"5\",\"8\"))\ndf5.show","user":"anonymous","dateUpdated":"2018-09-03T21:08:33+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df5: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: int, country: string ... 12 more fields]\n+-----+--------+--------------------+--------------------+------+-----+--------------+-------------------+-----------------+------------------+---------------------+--------------------+------------------+-------------------+\n|index| country|         description|         designation|points|price|      province|           region_1|         region_2|       taster_name|taster_twitter_handle|               title|           variety|             winery|\n+-----+--------+--------------------+--------------------+------+-----+--------------+-------------------+-----------------+------------------+---------------------+--------------------+------------------+-------------------+\n|    1|Portugal|This is ripe and ...|            Avidagos|    87| 15.0|         Douro|               null|             null|        Roger Voss|           @vossroger|Quinta dos Avidag...|    Portuguese Red|Quinta dos Avidagos|\n|    2|      US|Tart and snappy, ...|                null|    87| 14.0|        Oregon|  Willamette Valley|Willamette Valley|      Paul Gregutt|          @paulgwine |Rainstorm 2013 Pi...|        Pinot Gris|          Rainstorm|\n|    3|      US|Pineapple rind, l...|Reserve Late Harvest|    87| 13.0|      Michigan|Lake Michigan Shore|             null|Alexander Peartree|                 null|St. Julian 2013 R...|          Riesling|         St. Julian|\n|    5|   Spain|Blackberry and ra...|        Ars In Vitro|    87| 15.0|Northern Spain|            Navarra|             null| Michael Schachner|          @wineschach|Tandem 2011 Ars I...|Tempranillo-Merlot|             Tandem|\n|    8| Germany|Savory dried thym...|               Shine|    87| 12.0|   Rheinhessen|               null|             null|Anna Lee C. Iijima|                 null|Heinz Eifel 2013 ...|    Gewürztraminer|        Heinz Eifel|\n+-----+--------+--------------------+--------------------+------+-----+--------------+-------------------+-----------------+------------------+---------------------+--------------------+------------------+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1535623485067_1606212351","id":"20180830-120445_1855436585","dateCreated":"2018-08-30T12:04:45+0200","dateStarted":"2018-09-03T21:08:33+0200","dateFinished":"2018-09-03T21:08:35+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:212"},{"text":"%md\n### Exercise 6","user":"anonymous","dateUpdated":"2018-09-03T21:08:35+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 6</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535623623778_-1781483497","id":"20180830-120703_1058118667","dateCreated":"2018-08-30T12:07:03+0200","dateStarted":"2018-09-03T21:08:35+0200","dateFinished":"2018-09-03T21:08:35+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:213"},{"text":"val df6 = reviews.filter($\"index\".cast(IntegerType) isin (0,1,10,100)).select(\"country\", \"province\", \"region_1\", \"region_2\")\ndf6.show","user":"anonymous","dateUpdated":"2018-09-03T21:08:35+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df6: org.apache.spark.sql.DataFrame = [country: string, province: string ... 2 more fields]\n+--------+-----------------+------------+------------+\n| country|         province|    region_1|    region_2|\n+--------+-----------------+------------+------------+\n|   Italy|Sicily & Sardinia|        Etna|        null|\n|Portugal|            Douro|        null|        null|\n|      US|       California| Napa Valley|        Napa|\n|      US|         New York|Finger Lakes|Finger Lakes|\n+--------+-----------------+------------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1535625323737_1521675682","id":"20180830-123523_1168126640","dateCreated":"2018-08-30T12:35:23+0200","dateStarted":"2018-09-03T21:08:35+0200","dateFinished":"2018-09-03T21:08:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:214"},{"text":"%md\n### Exercise 7","user":"anonymous","dateUpdated":"2018-09-03T21:08:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 7</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535627033451_1424107292","id":"20180830-130353_1075926751","dateCreated":"2018-08-30T13:03:53+0200","dateStarted":"2018-09-03T21:08:37+0200","dateFinished":"2018-09-03T21:08:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:215"},{"text":"val df7 = reviews.filter($\"index\".cast(IntegerType) < 100).select(\"country\", \"variety\")\ndf7.count","user":"anonymous","dateUpdated":"2018-09-03T21:08:37+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df7: org.apache.spark.sql.DataFrame = [country: string, variety: string]\nres32: Long = 100\n"}]},"apps":[],"jobName":"paragraph_1535625394658_1410140095","id":"20180830-123634_807562426","dateCreated":"2018-08-30T12:36:34+0200","dateStarted":"2018-09-03T21:08:37+0200","dateFinished":"2018-09-03T21:08:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:216"},{"text":"%md\n### Exercise 8","user":"anonymous","dateUpdated":"2018-09-03T21:08:39+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 8</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535627041040_1120400735","id":"20180830-130401_1236413169","dateCreated":"2018-08-30T13:04:01+0200","dateStarted":"2018-09-03T21:08:39+0200","dateFinished":"2018-09-03T21:08:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:217"},{"text":"val df8 = reviews.filter($\"country\" === \"Italy\")\ndf8.show(5)","user":"anonymous","dateUpdated":"2018-09-03T21:08:39+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df8: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: int, country: string ... 12 more fields]\n+-----+-------+--------------------+------------+------+-----+-----------------+--------+--------+-------------+---------------------+--------------------+-----------------+-------------------+\n|index|country|         description| designation|points|price|         province|region_1|region_2|  taster_name|taster_twitter_handle|               title|          variety|             winery|\n+-----+-------+--------------------+------------+------+-----+-----------------+--------+--------+-------------+---------------------+--------------------+-----------------+-------------------+\n|    0|  Italy|Aromas include tr...|Vulkà Bianco|    87| null|Sicily & Sardinia|    Etna|    null|Kerin O’Keefe|         @kerinokeefe|Nicosia 2013 Vulk...|      White Blend|            Nicosia|\n|    6|  Italy|Here's a bright, ...|     Belsito|    87| 16.0|Sicily & Sardinia|Vittoria|    null|Kerin O’Keefe|         @kerinokeefe|Terre di Giurfo 2...|         Frappato|    Terre di Giurfo|\n|   13|  Italy|This is dominated...|       Rosso|    87| null|Sicily & Sardinia|    Etna|    null|Kerin O’Keefe|         @kerinokeefe|Masseria Settepor...|Nerello Mascalese|Masseria Setteporte|\n|   22|  Italy|Delicate aromas r...|   Ficiligno|    87| 19.0|Sicily & Sardinia| Sicilia|    null|Kerin O’Keefe|         @kerinokeefe|Baglio di Pianett...|      White Blend| Baglio di Pianetto|\n|   24|  Italy|Aromas of prune, ...|       Aynat|    87| 35.0|Sicily & Sardinia| Sicilia|    null|Kerin O’Keefe|         @kerinokeefe|Canicattì 2009 Ay...|     Nero d'Avola|          Canicattì|\n+-----+-------+--------------------+------------+------+-----+-----------------+--------+--------+-------------+---------------------+--------------------+-----------------+-------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535625465618_-1828261483","id":"20180830-123745_1054907318","dateCreated":"2018-08-30T12:37:45+0200","dateStarted":"2018-09-03T21:08:39+0200","dateFinished":"2018-09-03T21:08:40+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:218"},{"text":"%md\n### Exercise 9","user":"anonymous","dateUpdated":"2018-09-03T21:08:40+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 9</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535627076713_634664908","id":"20180830-130436_678259633","dateCreated":"2018-08-30T13:04:36+0200","dateStarted":"2018-09-03T21:08:40+0200","dateFinished":"2018-09-03T21:08:40+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:219"},{"text":"val df9 = reviews.filter($\"region_2\".isNotNull)\ndf9.show(5)","user":"anonymous","dateUpdated":"2018-09-03T21:08:40+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df9: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: int, country: string ... 12 more fields]\n+-----+-------+--------------------+--------------------+------+-----+----------+-----------------+-----------------+--------------+---------------------+--------------------+------------------+------------------+\n|index|country|         description|         designation|points|price|  province|         region_1|         region_2|   taster_name|taster_twitter_handle|               title|           variety|            winery|\n+-----+-------+--------------------+--------------------+------+-----+----------+-----------------+-----------------+--------------+---------------------+--------------------+------------------+------------------+\n|    2|     US|Tart and snappy, ...|                null|    87| 14.0|    Oregon|Willamette Valley|Willamette Valley|  Paul Gregutt|          @paulgwine |Rainstorm 2013 Pi...|        Pinot Gris|         Rainstorm|\n|    4|     US|Much like the reg...|Vintner's Reserve...|    87| 65.0|    Oregon|Willamette Valley|Willamette Valley|  Paul Gregutt|          @paulgwine |Sweet Cheeks 2012...|        Pinot Noir|      Sweet Cheeks|\n|   10|     US|Soft, supple plum...|      Mountain Cuvée|    87| 19.0|California|      Napa Valley|             Napa|Virginie Boone|              @vboone|Kirkland Signatur...|Cabernet Sauvignon|Kirkland Signature|\n|   12|     US|Slightly reduced,...|                null|    87| 34.0|California| Alexander Valley|           Sonoma|Virginie Boone|              @vboone|Louis M. Martini ...|Cabernet Sauvignon|  Louis M. Martini|\n|   14|     US|Building on 150 y...|                null|    87| 12.0|California|    Central Coast|    Central Coast| Matt Kettmann|        @mattkettmann|Mirassou 2012 Cha...|        Chardonnay|          Mirassou|\n+-----+-------+--------------------+--------------------+------+-----+----------+-----------------+-----------------+--------------+---------------------+--------------------+------------------+------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535627093659_-214235058","id":"20180830-130453_1177178807","dateCreated":"2018-08-30T13:04:53+0200","dateStarted":"2018-09-03T21:08:40+0200","dateFinished":"2018-09-03T21:08:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:220"},{"text":"%md\n### Exercise 10","user":"anonymous","dateUpdated":"2018-09-03T21:08:41+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 10</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535627154442_723805733","id":"20180830-130554_1928933189","dateCreated":"2018-08-30T13:05:54+0200","dateStarted":"2018-09-03T21:08:41+0200","dateFinished":"2018-09-03T21:08:41+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:221"},{"text":"val df10 = reviews.withColumn(\"points\", $\"points\".cast(IntegerType))\ndf10.printSchema\ndf10.createOrReplaceTempView(\"temp\")\n","user":"anonymous","dateUpdated":"2018-09-03T23:31:30+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df10: org.apache.spark.sql.DataFrame = [index: int, country: string ... 12 more fields]\nroot\n |-- index: integer (nullable = true)\n |-- country: string (nullable = true)\n |-- description: string (nullable = true)\n |-- designation: string (nullable = true)\n |-- points: integer (nullable = true)\n |-- price: double (nullable = true)\n |-- province: string (nullable = true)\n |-- region_1: string (nullable = true)\n |-- region_2: string (nullable = true)\n |-- taster_name: string (nullable = true)\n |-- taster_twitter_handle: string (nullable = true)\n |-- title: string (nullable = true)\n |-- variety: string (nullable = true)\n |-- winery: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1535627235659_-1328189711","id":"20180830-130715_982554348","dateCreated":"2018-08-30T13:07:15+0200","dateStarted":"2018-09-03T23:31:30+0200","dateFinished":"2018-09-03T23:31:31+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:222"},{"text":"%sql\nselect points, count(*) as n from temp group by points","user":"anonymous","dateUpdated":"2018-09-15T20:19:22+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","n":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n85\t9528\n81\t692\n91\t11358\n93\t6484\nnull\t31\n86\t12598\n94\t3757\n96\t523\n92\t9610\n88\t17203\n100\t19\n84\t6479\n87\t16931\n97\t229\n10\t1\n82\t1836\n80\t397\n95\t1535\n98\t77\n90\t15406\n83\t3025\n71\t1\n99\t33\n89\t12222\n"}]},"apps":[],"jobName":"paragraph_1535627262666_667956540","id":"20180830-130742_1241753705","dateCreated":"2018-08-30T13:07:42+0200","dateStarted":"2018-09-03T21:08:42+0200","dateFinished":"2018-09-03T21:08:45+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:223"},{"text":"%md\n### Exercise 11","user":"anonymous","dateUpdated":"2018-09-03T21:08:45+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 11</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535628082145_-1259000378","id":"20180830-132122_1138239320","dateCreated":"2018-08-30T13:21:22+0200","dateStarted":"2018-09-03T21:08:45+0200","dateFinished":"2018-09-03T21:08:45+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:224"},{"text":"%sql\nselect points, count(*) as n from (select * from temp limit 1000) group by points","user":"anonymous","dateUpdated":"2018-09-15T20:19:23+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","n":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n87\t221\n86\t103\n85\t110\n88\t74\n92\t95\n91\t102\n90\t155\n89\t80\n83\t2\n82\t5\n81\t1\n80\t1\n100\t1\n98\t1\n97\t4\n96\t5\n95\t10\n93\t30\n"}]},"apps":[],"jobName":"paragraph_1535627311869_-1471615944","id":"20180830-130831_1145391524","dateCreated":"2018-08-30T13:08:31+0200","dateStarted":"2018-09-03T21:08:45+0200","dateFinished":"2018-09-03T21:08:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:225"},{"text":"%md\n### Exercise 12","user":"anonymous","dateUpdated":"2018-09-03T21:08:46+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 12</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535628432561_-929393196","id":"20180830-132712_179544260","dateCreated":"2018-08-30T13:27:12+0200","dateStarted":"2018-09-03T21:08:46+0200","dateFinished":"2018-09-03T21:08:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:226"},{"text":"%sql\nselect points, count(*) as n from (select * from temp order by index desc limit 1000) group by points","user":"anonymous","dateUpdated":"2018-09-15T20:19:23+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n90\t212\n91\t82\n92\t32\n86\t81\n88\t99\n89\t85\n87\t184\n93\t148\n84\t53\n85\t24\n"}]},"apps":[],"jobName":"paragraph_1535627515203_1346076538","id":"20180830-131155_2015072453","dateCreated":"2018-08-30T13:11:55+0200","dateStarted":"2018-09-03T21:08:47+0200","dateFinished":"2018-09-03T21:08:48+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:227"},{"text":"%md\n### Exercise 13","user":"anonymous","dateUpdated":"2018-09-03T21:08:48+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"index":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 13</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535629923850_273344976","id":"20180830-135203_643686101","dateCreated":"2018-08-30T13:52:03+0200","dateStarted":"2018-09-03T21:08:48+0200","dateFinished":"2018-09-03T21:08:48+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:228"},{"text":"%sql\nselect points, count(*) as n from temp where country = \"Italy\" group by points","user":"anonymous","dateUpdated":"2018-09-15T20:19:24+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"points":"string","count(1)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"points","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"points\tn\n85\t1145\n81\t20\n91\t1351\n93\t846\nnull\t4\n86\t2067\n94\t494\n96\t63\n92\t1226\n88\t3103\n100\t4\n84\t560\n87\t3442\n97\t43\n82\t69\n80\t5\n95\t215\n98\t12\n90\t2382\n83\t206\n99\t9\n89\t2274\n"}]},"apps":[],"jobName":"paragraph_1535628588763_-1695042615","id":"20180830-132948_1690321377","dateCreated":"2018-08-30T13:29:48+0200","dateStarted":"2018-09-03T21:08:48+0200","dateFinished":"2018-09-03T21:08:51+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:229"},{"text":"%md\n### Exercise 14","user":"anonymous","dateUpdated":"2018-09-03T21:08:51+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 14</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535629610164_-1561389444","id":"20180830-134650_663215352","dateCreated":"2018-08-30T13:46:50+0200","dateStarted":"2018-09-03T21:08:51+0200","dateFinished":"2018-09-03T21:08:52+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:230"},{"text":"%sql\nselect country, count(*) as n from temp where country = \"Italy\" and points >= 90 or country = \"France\" and points >= 90 group by country","user":"anonymous","dateUpdated":"2018-09-15T20:19:24+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"country":"string","n":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"country","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"n","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"country\tn\nFrance\t9192\nItaly\t6647\n"}]},"apps":[],"jobName":"paragraph_1535629797411_-3236335","id":"20180830-134957_738273721","dateCreated":"2018-08-30T13:49:57+0200","dateStarted":"2018-09-03T23:31:36+0200","dateFinished":"2018-09-03T23:31:37+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:231"},{"text":"%md\n## Summary functions and maps","user":"anonymous","dateUpdated":"2018-09-03T21:08:54+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Summary functions and maps</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1535631775002_2057441260","id":"20180830-142255_785892508","dateCreated":"2018-08-30T14:22:55+0200","dateStarted":"2018-09-03T21:08:54+0200","dateFinished":"2018-09-03T21:08:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:232"},{"text":"%md\n### Exercise 1","user":"anonymous","dateUpdated":"2018-09-03T21:09:20+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 1</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1535783923280_-1235753836","id":"20180901-083843_1048221918","dateCreated":"2018-09-01T08:38:43+0200","dateStarted":"2018-09-03T21:09:20+0200","dateFinished":"2018-09-03T21:09:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:233"},{"text":"// Slightly modified since there's no way to accurately and efficiently get the median using Spark since it requires all data to be in the same place which goes against the purpose of Spark.\nreviews.select(mean($\"points\")).show","user":"anonymous","dateUpdated":"2018-09-03T21:10:11+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+\n|      avg(points)|\n+-----------------+\n|88.44617681462783|\n+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1535783940048_1338000824","id":"20180901-083900_2114853295","dateCreated":"2018-09-01T08:39:00+0200","dateStarted":"2018-09-03T21:08:55+0200","dateFinished":"2018-09-03T21:08:56+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:234"},{"text":"%md\n### Exercise 2","user":"anonymous","dateUpdated":"2018-09-03T21:13:38+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 2</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536002006717_-2103243371","id":"20180903-211326_984176973","dateCreated":"2018-09-03T21:13:26+0200","dateStarted":"2018-09-03T21:13:38+0200","dateFinished":"2018-09-03T21:13:38+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:235"},{"text":"reviews.select(\"country\").distinct.show","user":"anonymous","dateUpdated":"2018-09-03T21:12:13+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|             country|\n+--------------------+\n|              Turkey|\n|             Germany|\n| marked by tart c...|\n|              France|\n|              Greece|\n|                null|\n|            Slovakia|\n|           Argentina|\n|Bordeaux-style Re...|\n|                Peru|\n|               India|\n|               China|\n|               Chile|\n| fine and extreme...|\n|             Croatia|\n|               Italy|\n|                  90|\n|               Spain|\n|                  US|\n|             Morocco|\n+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1535784091216_862846824","id":"20180901-084131_561489679","dateCreated":"2018-09-01T08:41:31+0200","dateStarted":"2018-09-03T21:12:13+0200","dateFinished":"2018-09-03T21:12:15+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:236"},{"text":"%md\n### Exercise 3","user":"anonymous","dateUpdated":"2018-09-03T21:13:46+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 3</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536001928787_-1683644787","id":"20180903-211208_1831533604","dateCreated":"2018-09-03T21:12:08+0200","dateStarted":"2018-09-03T21:13:46+0200","dateFinished":"2018-09-03T21:13:46+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:237"},{"text":"reviews.groupBy(\"country\").count.orderBy($\"count\".desc).show","user":"anonymous","dateUpdated":"2018-09-03T21:17:18+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----+\n|     country|count|\n+------------+-----+\n|          US|54504|\n|      France|22093|\n|       Italy|19540|\n|       Spain| 6645|\n|    Portugal| 5691|\n|       Chile| 4472|\n|   Argentina| 3800|\n|     Austria| 3345|\n|   Australia| 2329|\n|     Germany| 2165|\n| New Zealand| 1419|\n|South Africa| 1401|\n|      Israel|  505|\n|      Greece|  466|\n|      Canada|  257|\n|     Hungary|  146|\n|    Bulgaria|  141|\n|     Romania|  120|\n|     Uruguay|  109|\n|      Turkey|   90|\n+------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1536002045775_668255233","id":"20180903-211405_678132739","dateCreated":"2018-09-03T21:14:05+0200","dateStarted":"2018-09-03T21:17:18+0200","dateFinished":"2018-09-03T21:17:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:238"},{"text":"%md\n### Exercise 4","user":"anonymous","dateUpdated":"2018-09-03T21:17:34+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 4</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536002121123_2020328081","id":"20180903-211521_982741147","dateCreated":"2018-09-03T21:15:21+0200","dateStarted":"2018-09-03T21:17:34+0200","dateFinished":"2018-09-03T21:17:34+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:239"},{"text":"// Again, using mean instead of median for above reasons.\n\nval meanPrice = reviews.select(mean($\"points\")).as[Double].take(1)(0)\nval df4 = reviews.select($\"price\" - meanPrice).show","user":"anonymous","dateUpdated":"2018-09-03T21:39:32+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"meanPrice: Double = 88.44617681462783\n+---------------------------+\n|(price - 88.44617681462783)|\n+---------------------------+\n|                       null|\n|         -73.44617681462783|\n|         -74.44617681462783|\n|         -75.44617681462783|\n|        -23.446176814627833|\n|         -73.44617681462783|\n|         -72.44617681462783|\n|         -64.44617681462783|\n|         -76.44617681462783|\n|         -61.44617681462783|\n|         -69.44617681462783|\n|         -58.44617681462783|\n|         -54.44617681462783|\n|                       null|\n|         -76.44617681462783|\n|         -64.44617681462783|\n|         -58.44617681462783|\n|         -75.44617681462783|\n|         -60.44617681462783|\n|         -56.44617681462783|\n+---------------------------+\nonly showing top 20 rows\n\ndf4: Unit = ()\n"}]},"apps":[],"jobName":"paragraph_1536002254840_-1307642189","id":"20180903-211734_91939549","dateCreated":"2018-09-03T21:17:34+0200","dateStarted":"2018-09-03T21:28:30+0200","dateFinished":"2018-09-03T21:28:32+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:240"},{"text":"%md\n### Exercise 5","user":"anonymous","dateUpdated":"2018-09-03T21:29:03+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 5</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536002938966_-510639309","id":"20180903-212858_377464590","dateCreated":"2018-09-03T21:28:58+0200","dateStarted":"2018-09-03T21:29:03+0200","dateFinished":"2018-09-03T21:29:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:241"},{"text":"reviews.select(max($\"points\" / $\"price\")).show","user":"anonymous","dateUpdated":"2018-09-03T21:32:52+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+\n|max((points / price))|\n+---------------------+\n|                 21.5|\n+---------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1536002937560_-391544807","id":"20180903-212857_595874290","dateCreated":"2018-09-03T21:28:57+0200","dateStarted":"2018-09-03T21:32:53+0200","dateFinished":"2018-09-03T21:32:54+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:242"},{"text":"%md\n### Exercise 6","user":"anonymous","dateUpdated":"2018-09-03T21:33:21+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 6</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536002306874_855955788","id":"20180903-211826_1431985014","dateCreated":"2018-09-03T21:18:26+0200","dateStarted":"2018-09-03T21:33:21+0200","dateFinished":"2018-09-03T21:33:21+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:243"},{"text":"val tropical = reviews.select(\"description\").filter($\"description\".contains(\"tropical\")).count()\nval fruity = reviews.select(\"description\").filter($\"description\".contains(\"fruity\")).count()\nval counts = Map(\"Tropcial\" -> tropical, \"Fruity\" -> fruity)\nprintln(counts)","user":"anonymous","dateUpdated":"2018-09-03T21:40:52+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"tropical: Long = 3607\nfruity: Long = 9090\ncounts: scala.collection.immutable.Map[String,Long] = Map(Tropcial -> 3607, Fruity -> 9090)\nMap(Tropcial -> 3607, Fruity -> 9090)\n"}]},"apps":[],"jobName":"paragraph_1536003200978_-935158837","id":"20180903-213320_769160796","dateCreated":"2018-09-03T21:33:20+0200","dateStarted":"2018-09-03T21:40:52+0200","dateFinished":"2018-09-03T21:40:55+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:244"},{"text":"%md\n### Exercise 7","user":"anonymous","dateUpdated":"2018-09-03T21:41:07+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 7</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536003341157_-1201875371","id":"20180903-213541_5611427","dateCreated":"2018-09-03T21:35:41+0200","dateStarted":"2018-09-03T21:41:07+0200","dateFinished":"2018-09-03T21:41:07+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:245"},{"text":"val nonNullDF = reviews.filter($\"country\".isNotNull && $\"variety\".isNotNull)\nval df7 = nonNullDF.select(concat($\"country\", lit(\" - \"), $\"variety\").as(\"col\"))\ndf7.groupBy(\"col\").count().show","user":"anonymous","dateUpdated":"2018-09-03T21:48:20+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"nonNullDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [index: int, country: string ... 12 more fields]\ndf7: org.apache.spark.sql.DataFrame = [col: string]\n+--------------------+-----+\n|                 col|count|\n+--------------------+-----+\n|Argentina - Riesling|    2|\n|US - Sangiovese-C...|    6|\n| fine and extreme...|    1|\n|Spain - Cabernet ...|    3|\n| US - Cabernet Franc| 1003|\n|US - Marsanne-Rou...|   17|\n|         US - Shiraz|   47|\n|Argentina - Nebbiolo|    4|\n|Spain - Tinta del...|    2|\n|Switzerland - Merlot|    1|\n|Austria - Caberne...|    1|\n|US - Cabernet Fra...|    2|\n|   Bulgaria - Muscat|    1|\n|  Italy - Prié Blanc|    6|\n|Spain - Monastrel...|   21|\n|Portugal - Red Blend|    7|\n|       US - Symphony|    5|\n|Austria - Zierfan...|    5|\n| South Africa - Rosé|   27|\n|         US - Rosato|    5|\n+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1536003666976_773564174","id":"20180903-214106_4283314","dateCreated":"2018-09-03T21:41:06+0200","dateStarted":"2018-09-03T21:48:20+0200","dateFinished":"2018-09-03T21:48:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:246"},{"text":"%md\n## Grouping and sorting","user":"anonymous","dateUpdated":"2018-09-03T21:48:44+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Grouping and sorting</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1536004114787_177348323","id":"20180903-214834_809265511","dateCreated":"2018-09-03T21:48:34+0200","dateStarted":"2018-09-03T21:48:44+0200","dateFinished":"2018-09-03T21:48:44+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:247"},{"text":"%md\n### Exercise 1","user":"anonymous","dateUpdated":"2018-09-03T22:25:02+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 1</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536006297574_-720614480","id":"20180903-222457_157916388","dateCreated":"2018-09-03T22:24:57+0200","dateStarted":"2018-09-03T22:25:02+0200","dateFinished":"2018-09-03T22:25:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:248"},{"text":"val df1 = reviews.groupBy(\"taster_twitter_handle\").count.show","user":"anonymous","dateUpdated":"2018-09-03T22:24:43+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+-----+\n|taster_twitter_handle|count|\n+---------------------+-----+\n|             @bkfiona|   27|\n|                 Napa|    1|\n|            @laurbuzz| 1832|\n|               @JoeCz| 5139|\n|               Oregon|    1|\n|                   85|    1|\n|  one of the best ...|    1|\n|                 null|31213|\n|       Joe Czerwinski|    3|\n|                 17.0|    2|\n|                 18.0|    1|\n|                 10.0|    1|\n| Montevina 2010 Pi...|    1|\n|          @wineschach|15133|\n|     Anne Krebiehl MW|    2|\n|        @wawinereport| 4966|\n|              @vboone| 9537|\n|       @worldwineguys| 1005|\n|            Il Barone|    1|\n|          @AnneInVino| 3683|\n+---------------------+-----+\nonly showing top 20 rows\n\ndf1: Unit = ()\n"}]},"apps":[],"jobName":"paragraph_1536003791060_1995201297","id":"20180903-214311_1317381063","dateCreated":"2018-09-03T21:43:11+0200","dateStarted":"2018-09-03T22:24:43+0200","dateFinished":"2018-09-03T22:24:44+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:249"},{"text":"%md\n### Exercise 2","user":"anonymous","dateUpdated":"2018-09-03T22:25:14+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Exercise 2</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1536006274496_-627729725","id":"20180903-222434_54667021","dateCreated":"2018-09-03T22:24:34+0200","dateStarted":"2018-09-03T22:25:14+0200","dateFinished":"2018-09-03T22:25:14+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:250"},{"text":"val df2 = reviews.groupBy(\"points\").max(\"price\").orderBy($\"points\".asc).show","user":"anonymous","dateUpdated":"2018-09-03T23:26:08+0200","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------+\n|points|max(price)|\n+------+----------+\n|    80|      69.0|\n|    81|     130.0|\n|    82|     150.0|\n|    83|     225.0|\n|    84|     225.0|\n|    85|     320.0|\n|    86|     170.0|\n|    87|     800.0|\n|    88|    3300.0|\n|    89|     500.0|\n|    90|     510.0|\n|    91|    2013.0|\n|    92|     750.0|\n|    93|     770.0|\n|    94|    1125.0|\n|    95|     973.0|\n|    96|    2500.0|\n|    97|    2000.0|\n|    98|    1900.0|\n|    99|     850.0|\n+------+----------+\nonly showing top 20 rows\n\ndf2: Unit = ()\n"}]},"apps":[],"jobName":"paragraph_1536006313998_-687649473","id":"20180903-222513_508499016","dateCreated":"2018-09-03T22:25:13+0200","dateStarted":"2018-09-03T23:26:08+0200","dateFinished":"2018-09-03T23:26:10+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:251"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1536006344193_-1794365071","id":"20180903-222544_2076615997","dateCreated":"2018-09-03T22:25:44+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:252"}],"name":"dataframe","id":"2DR7EVDR9","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}